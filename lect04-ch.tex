% Лекции Сергея Борисовича Стечкина
% Внесены исправления Ю.Н.Субботина и Н.И.Черныха, версия 30.06.2009
% Внесены исправления Н.И.Черныха, версия 29.07.2009
% Внесена грамматическая и ТеХ-правка М.Дейкаловой, версия 05.08.09

\chapter{Квадратурные процессы\\ и интерполирование с производными}
%%{Лекция 4.}

\section{Квадратурные формулы}

В функциональном пространстве  $B$ с определенными всюду на $[a,b]$ функциями
$f\in B$ и нормой $\|f\|$
рассмотрим квадратурную формулу
\begin{equation}
\label{Quad}
  \Cal L(f)=\sum\limits_{k=1}^n A_kf(x_k)
\end{equation}
для приближенного вычисления какого-то функционала. Здесь и далее $A_k=A_k(n,\Cal
L),$ $\{x_k\}_{1}^n$ -- набор различных точек из $[a,b].$

Квадратурная формула будет линейным функционалом, если значение
функции в точке есть линейный (т.\,е. аддитивный,
однородный и ограниченный) функционал. Ясно, что $\Cal
L$~-- {линейный} функционал, если $B=C[a,b].$ Обычно квадратурные
формулы рассматривают в классе функций, совпадающим либо с
самим пространством $C[a,b],$ либо с
{иначе} метризованным подпространством $B$ этого же пространства, например,
$B=C^{(r)}[a,b]$ с нормой Соболева $\|f\|=\|f\|_{C[a,b]}+\|f^{(r)}\|_{C[a,b]}.$

Таким образом, мы будем рассматривать квадратурные формулы
в пространствах, в которых значение функции в точке
есть линейный функционал.

1. Любая квадратурная формула, если ее рассматривать в
пространстве, где она есть линейный функционал, имеет
норму
\[
  \|\Cal L \|=\sup_{\|f\| \le 1} |\Cal L (f)|
\]
-- это ее первая характеристика. В пространстве {$C[a,b]$}
получаем оценку
\[
 \|\Cal L \|_{C} \le
              \sum\limits_{k=1}^n |A_k|
\]
и равенство имеет место для {$f \in C[a,b]$} таких, что $f(x_k)=\sign A_k.$ Такая
функция всегда существует (см. рис.~\ref{r4-1}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\vspace{3mm}
% \noindent

 %\bigskip
 %\begin{picture}(90,130)
 %\put(90,130){\special{em: graph pict4-1.pcx}}
 %\end{picture}

 %\refstepcounter{ris}\label{r4-1}

 %\centerline{Рис.~\theris}
 %\bigskip

  \bigskip
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.7\textwidth]{pict04-1.eps}
\end{center}
 \bigskip
 \refstepcounter{ris}\label{r4-1}

 \centerline{Рис.~\theris}
 \bigskip
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\vspace{1mm}
%\noindent\centerline{\hspace{-6cm}рис.11}

%\hbox to 0.5cm {}{\special{em:graph pict11.pcx}}
%\vspace{4.6cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\noindent \hskip3.0cm {рис. 11}
%\bigskip

\noindent Следовательно,
\[
 \|\Cal L \|_C=\sum\limits_{k=1}^n |A_k|.
\]
Если при вычислении значений $f(x_k)$ функции $f$
мы ошиблись на $\e,$ то в квадратурной формуле мы ошибемся
не больше, чем на $\e \sum\limits_{k=1}^n |A_k|.$

2. Вторая характеристика квадратурной формулы~-- область
точности квадратурной формулы.
Квадратурная формула~-- вычислительный метод для
нахождения значения какого-то функционала, например, функционала
\[
  M(f)=\int_a^b f(x) \,dx.
\]
Вообще говоря, $M(f) \ne \Cal L(f).$
Однако для любой квадратурной формулы и соответствующего
функционала $M$ существует множество
$\Cal Q$ такое, что
\[
  M(f) = \Cal L(f) \qquad \forall f \in \Cal Q.
\]
Это множество $\Cal Q$ называется {\it областью точности квадратурной формулы для
$M(f)$.}

Для любой квадратурной формулы область точности не
пуста (так как тождественный нуль всегда лежит в
$\Cal Q$) и в частных случаях может совпадать даже со всем пространством.

\begin{defi}
Если для некоторого $m,$ $\Cal P_m \subset \Cal Q,$ {a $\Cal
P_{m+1}\not\subset \Cal Q,$} то будем говорить, что {\it
квадратурная формула имеет точность $m.$}
\end{defi}

В частности, квадратурная формула имеет точность $m=0$ для $M(f),$
если для любой постоянной $c$
выполнено $M(c) = \Cal L(c)=c\cdot \sum\limits_{k=1}^n A_k$
{и $M(f)\ne\sum{A_kx_k}$ при $f(x)\equiv x$}.
Если $
M(f)=\displaystyle\int_a^b f(x)\, dx,$ то $M(c)=(b-a)c$
{и для точности $m=0$ квадратурной формулы~(\ref{r4-1})}
необходимо и достаточно, чтобы
\[
  \sum\limits_{k=1}^n A_k=b-a\quad \mbox{и}\quad \sum\limits_{k=1}^n
  A_kx_k\ne\frac12(b^2-a^2).
\]
Первое из этих неравенств является необходимым и
достаточным для того, чтобы формула~(\ref{r4-1}) для функционала
$\displaystyle\int_a^b f(x)\, dx$ имела точность $m\ge 0.$
В общем случае точность любой квадратурной формулы будет не менее
$m,$ если она точна для $1,x,x^2,\ldots,x^m.$

\section{Квадратурные процессы и их сходимость}

Если в пространстве
{$C[a,b]$} заданы линейный функционал
$M(f)$ и последовательность квадратурных формул
$\Cal L_n$\  $(n \in \bN),$ то говорим, что
$\{\Cal L_n\}$ определяет квадратурный процесс.

\begin{task}
При каких условиях для любой $f$
из пространства верно соотношение
\[
  \Cal L_n(f) \to M(f) \qquad (n \to \infty)?
\]
\end{task}

Это есть сходимость линейных функционалов, притом слабая. Следовательно, надо, чтобы
последовательность $\{\Cal L_n\}$ была слабо сходящейся.

\vspace{5mm}
{\bf 1. Достаточные условия сходимости квадратурного процесса}
\vspace{5mm}

\begin{teo}\label{kvad1}
Квадратурный процесс будет сходящимся, если

$1)$ последовательность норм квадратурных формул
$\{\Cal L_n\}$ ограничена,

$2)$ $m(n) \to \infty$ {при} $n \to \infty,$
где
$m(n)$~-- точность {квадратурной формулы} $\Cal L_n.$
\end{teo}

\begin{proof}
{Не уменьшая общности, можно считать, что $m(n)$}
{возрастает вместе с $n.$ Тогда $\Cal L_n(p)=M(p)$
для любого многочлена $p(x)\in \Cal P_m$ при} {$m(n)\ge m,$
т.\,е. $L_n(p)\to M(p)$~ $(n\to\infty)$. Поэтому} для любого $m$
квадратурный процесс сходится {на $\Cal P_m$}. Следовательно, квадратурный процесс
сходится на {${\bigcup\limits_m} \Cal P_m.$} Но по теореме
Вейерштрасса {$\overline{{\bigcup\limits_m} \Cal P_m}=C[a,b],$} значит, квадратурный процесс
сходится на всюду плотном множестве, а нормы {$\|\Cal L_n\|_C$} ограничены.
Поэтому квадратурный процесс
сходится на {$C[a,b].$}
\end{proof}

\begin{Remark}
{Квадратурный процесс Котеса~(\ref{3-3.3}) удовлетворяет условию 2
теоремы~\ref{kvad1},} {так как
$m(n)=n$ (см. раздел~\ref{3.4}, п.~1). Из точности} квадратурных формул на
$[a,b]$ {для констант следует, что в~(\ref{3-3.3})}
$\sum\limits_{k=1}^n A_k=b-a.$ Если еще
все коэффициенты Котеса $A_k=A_k(n)$ неотрицательны, то нормы квадратурного процесса
\[
  \sum\limits_{k=1}^n |A_k|=
  \sum\limits_{k=1}^n A_k=b-a
\]
будут ограничены {и квадратурный процесс Котеса будет удовлетворять
теореме~\ref{kvad1}.}
\end{Remark}

\vspace{5mm}
{\bf 2. Некоторые квадратурные процессы и их остаточные члены}
\vspace{5mm}

Мы уже рассматривали квадратурные формулы Котеса для вычисления
$M(f)=\ds\int_a^b f(x)\,dx$:
\[
  \Cal L_n (f)=\int_a^b p_n(x,f)\,dx=
  \sum\limits_{k=0}^n A_k f(x_k),\qquad A_k=A_k(n),
\]
где {$p_n(x,f)$~-- интерполяционный многочлен Лагранжа на сетке
$\{x_k\}_{k=0}^n\subset[a,b],$}  $A_k=\ds\int_a^b l_k(x)\,dx.$ Эта квадратурная
формула имеет точность {не меньше} $n$ и
\[
  \|\Cal L_n(f)\|=\sum\limits_{k=1}^n |A_k|.
\]
Пусть $f \in C^{(n+1)}$
{и $\|f^{(n+1)}\|_C=M_{n+1}$}.
Тогда
$$
  \Bigl|  \int_a^b f(x)\,dx - \Cal L_n(f) \Bigr|=
  \Bigl|  \int_a^b (f(x) - p_n(x,f))\,dx \Bigr|=
$$
$$
  =\Bigl|  \int_a^b \frac{f^{(n+1)}(\xi )}{(n+1)!}\omega (x)\,dx \Bigr| \le
  \frac{M_{n+1}}{(n+1)!}   \int_a^b |\omega (x)|\, dx.
$$
Аналогичные оценки можно написать через
$M_r$ для $0 \le r \le n+1$,
используя полученные ранее оценки~(\ref{lab1}) для $|f(x)-p_n(x,f)|$
через $\| f^{(r)}\|.$

\vspace{3mm}
{\bf 3. Квадратурные формулы Гауссовского типа}
\vspace{3mm}

Мы рассмотрели квадратурную формулу $\sum\limits_{k=0}^n A_k f(x_k),$ которая дает
приближенное значение для $\ds\int_a^b f(x)\,dx$ и точна для любой $f \in \Cal P_n.$
Формула строится по узлам $\{x_k\}_{k=0}^n$ и имеет $n+1$ коэффициентов
$\{A_k\}_{k=0}^n,$ т.\,е. определяется $2(n+1)$ параметрами.

\begin{teo}
Пусть
$L_{n+1}$~-- некоторое {$(n+1)$-мерное} подпространство из
$C[a,b].$ Тогда существует
{$(n+1)$-точечная}
квадратурная формула, которая является
точной для любой $f \in L_{n+1}.$
\end{teo}

\begin{proof}
Пусть $\phi_0(x),\dots ,\phi_n(x)$~-- система линейно
независимых функций в $L_{n+1}.$ Тогда найдутся точки $x_i$
$(i=0,\dots ,n)$ такие, что
\[
  \det |\phi_j(x_i)| \ne 0.
\]
{(Этот факт можно доказать индукцией по $n,$ начав с $\varphi_0(x)\neqv 0$ на $[a,b]$).}
В качестве узлов квадратурной формулы возьмем эти точки
$\{x_i\}_{i=0}^n.$
Тогда для определения $A_k$
получим систему линейных уравнений
\[
  \sum\limits_{k=0}^n A_k \phi_j(x_k)=\int_a^b
  \phi_j(x)\,dx,\qquad j=0,\ldots,n,
\]
из которой $A_k$
определяются однозначно (определитель системы не равен
нулю) и формула будет точна для любой $f \in L_{n+1}$
(так как $f$
линейно выражается через $\phi_k,$ $k=0, \dots ,n,$
а на $\phi_k$
формула точна).
\end{proof}

\begin{task} Пусть $L_m$ {-- подпространство размерности $m$ из $C[a,b],$}\   $n+1<
m \le 2(n+1).$ Когда можно построить {$(n+1)$-точечную} квадратурную формулу, которая
была бы точна на всем $L_m$?
\end{task}

Ответ неизвестен. Если же $L_m=\Cal P_{m-1},$ то задача решена Гауссом.

\begin{teo}[К.\,Ф.\,Гаусс]
Существуют узлы $\{x_0,x_1,\dots ,x_n\}$ {и коэффициенты} $A_0,A_1,\dots, A_n$ такие,
что для любого многочлена $p \in \Cal P_{2n+1}$ квадратурная формула точна, т.\,е.
\[
  \sum\limits_{k=0}^n A_k p(x_k)=\int_a^b p(x)\,dx.
\]
\end{teo}

\begin{proof}
1) Пусть такая квадратурная формула, точная для любого $p \in \Cal P_{2n+1},$
существует. Построим многочлен $\omega(x)=(x-x_0)\cdots (x-x_n) \in \Cal P_{n+1}.$
Возьмем любой $q(x) \in \Cal P_{n}.$ Покажем, что
\[
  \int_a^b \omega (x)q(x)\,dx =0, \qquad  q \in \Cal P_{n},
\]
т.\,е. $\omega(x)$ ортогонален любому многочлену степени не
выше $n.$

Действительно, возьмем $p(x)=\omega(x)q(x)$~-- многочлен
степени не выше $2n+1,$ для него, по предположению,
квадратурная формула точна, т.\,е. имеют место равенства
\[
  \int_a^b \omega (x)q(x)\,dx =
  \sum\limits_{k=0}^n A_k p(x_k)=0.
\]
Здесь сумма равна нулю, так как
$p(x_k)=\omega (x_k)q(x_k)=0\cdot q(x_k)=0.$ Таким образом,
многочлен $\omega(x)$ ортогонален любому многочлену степени не выше $n.$

Итак, если существует квадратурная формула Гаусса, то
ее узлы есть корни многочлена, ортогонального любому
$q$ из $\Cal P_{n}.$
Такие многочлены можно получить, если взять систему функций
$\{x^k \}_{k=0}^{n+1}$
и ортогонализовать на $[a,b],$
например, методом Шмидта относительно скалярного произведения
$(f,g)=\ds\int_a^b f(x)g(x) dx.$ Получим многочлены Лежандра $\{P_k(x)\}.$
Многочлен Лежандра $P_{n+1}(x)$
обладает нужными свойствами: имеет
коэффициент при старшей степени, равный $1,$ ортогонален пространству $\Cal
P_n$, его нули являются простыми и принадлежат $[a,b]$.
Последний факт вытекает из следующего простого наблюдения:
если бы многочлен $P_{n+1}(x)$ имел на $[a,b]$ не
более $n$ точек перемен знака, то для полинома $q\in \Cal
P_n$ с нулями в этих точках было бы $\left|\ds\int_a^b q(x)P_{n+1}(x)\,dx\right|=
\ds\int_a^b |q(x)||P_{n+1}(x)|\,dx>0.$

Возьмем нули многочлена Лежандра $P_{n+1}(x),$
в качестве нужной нам системы узлов квадратурной формулы,
которую мы ищем.

2) Итак, возьмем нули
$\{x_k \}_{k=0}^{n}$
многочлена Лежандра,
ортогонального любому многочлену степени не выше $n.$
Построим квадратурную формулу {Котеса с узлами $\{x_k \}_{k=0}^{n}$}
\newline
$\sum\limits_{k=0}^n A_k f(x_k),$ она, как мы знаем, точна для
любого $q \in \Cal P_n.$ Докажем, что эта формула будет
формулой Гауссовского типа, т.\,е. она будет точна также и на
любом многочлене степени не выше $2n+1.$

Пусть
$p(x)$~-- любой многочлен из
$\Cal P_{2n+1}.$ {По построению}
многочлен $\omega(x)=\prod\limits_{k=0}^n(x-x_k)=P_{n+1}(x)$
совпадает с
многочленом Лежандра и
принадлежит
$\Cal P_{n+1}.$
Представим
\[
  p(x)=q(x)\cdot \omega(x)+r(x),
\]
где $q(x)$ и $r(x)$ принадлежат $\Cal P_{n}.$ Заметим, что $p(x_k)=r(x_k)$
Тогда, так как многочлен $\omega(x)=P_{n+1}(x)$ ортогонален $q(x)$
и формула точна для $r(x),$ имеем
%\begin{multline*}
\[
\int_a^b p(x)\,dx=\int_a^b q(x)\omega(x) dx +\int_a^b r(x)\,dx
               =\int_a^b r(x)\,dx =\sum\limits_{k=0}^n A_k r(x_k)=
                \sum\limits_{k=0}^n A_k p(x_k),
\]
%\end{multline*}
т.\,е.
\[
  \int_a^b p(x)\,dx=
                \sum\limits_{k=0}^n A_k p(x_k),\qquad p \in \Cal P_{2n+1}.
\]
Значит, построенная нами формула {имеет гауссовский тип.} Теорема доказана.
\end{proof}

\begin{Remark}
Квадратурная формула гауссовского типа существует для любого {целого} $n{\ge0}$.
\end{Remark}

\begin{teo}
Все коэффициенты Котеса в квадратурной формуле
Гаусса не\-отрица\-тельны.
\end{teo}

\begin{proof} Действительно, для любого многочлена $p \in \Cal P_{2n+1}$ справедливо равенство
\begin{equation}
\label{Gauss}
  \sum\limits_{k=0}^n A_k p(x_k)=\int_a^b p(x)\,dx,
\end{equation}
в частности, для квадрата $l_k^2(x)$ {каждого}
фундаментального полинома Лагранжа {$l_{k}(x)$
с узлами $x_0,x_1,\ldots,x_n$ (степень такого квадрата не превышает $2n$).} Так как
{$l_m^2(x_k)=\delta_{km},$}
то подставляя {$p(x)=l_m^2(x)$} в~(\ref{Gauss}), получаем
\[
  A_k=\int_a^b l_k^2 (x)dx >0{,\qquad k=0,1,\ldots,n},
\]
что и требовалось доказать.
\end{proof}

Заметим, что так как квадратурная формула точна и на
константах, то
\[
  \sum\limits_{k=0}^n |A_k|=\sum\limits_{k=0}^n A_k=b-a.
\]
Значит, выполняются все условия теоремы о сходимости квадратурного процесса (нормы
ограничены и точность $m=2n+1 \to \infty$ при $n \to \infty$). Применяя эту
теорему, получаем

\begin{Proposition}
{Квадратурный} процесс Гаусса $\sum\limits_{k=0}^n A_k(n) f(x_k^n)$ для любой $f \in
C[a,b]$ сходится к $\ds\int_a^b f(x)\,dx.$
\end{Proposition}

%т.\,е. квадратурный процесс Гаусса является сходящимся
%для любой непрерывной функции.

\section{Интерполирование с производными}

Общая постановка задачи состоит в следующем.

З\,а\,д\,а\,ч\,а\ \ Б\,и\,р\,к\,г\,о\,ф\,а.\quad
Пусть функция $f$
определена на отрезке $[a,b]$ и, более того, $f \in C^{(m)}[a,b].$
Пусть заданы точки
$x_1,x_2,\dots ,x_k,$
и пусть задана таблица параметров
\vspace{3mm}
\begin{center}
\begin{tabular}{|l||c|r|} \hline
$x_1$ & $0 \le r_0^{(1)} < r_1^{(1)}< \cdots < r_{s_1}^{(1)} \le m$ & $s_1+1$ \\  \hline
$x_2$ & $0 \le r_0^{(2)} < r_1^{(2)}< \cdots < r_{s_2}^{(2)} \le m$ & $s_2+1$ \\  \hline
$\cdot$ & $\cdots$  & $\cdot$ \\  \hline
$\cdot$ & $\cdots$  & $\cdot$ \\  \hline
$\cdot$ & $\cdots$  & $\cdot$ \\  \hline
$x_k$ & $0 \le r_0^{(k)} < r_1^{(k)}< \cdots < r_{s_k}^{(k)} \le m$ & $s_k+1$ \\  \hline
\end{tabular}
\end{center}
\vspace{3mm}
всего $N=s_1+s_2+\cdots +s_k+k$
параметров {$r_i^{(j)}$}. Хотим построить многочлен
$p(x) \in \Cal P_{N-1}$ такой, что
\[
  p^{(r_s^{(i)})}(x_i)=f^{(r_s^{(i)})}(x_i),
\]
$s=0,1,\dots,s_i,$~ $i=1,2,\dots ,k.$

Какие условия надо наложить на числа
$r_s^{(i)},$ чтобы для любых чисел $x_1,\dots ,x_k,$
принадлежащих отрезку $[a,b],$
задача имела решение?


Ответ на этот вопрос неизвестен.
Существуют простейшие случаи, когда задача не всегда
имеет решение.
Существуют случаи, когда задача всегда разрешима.

\ex Придумать таблицу, чтобы задача не всегда была разрешима
(указание: {$3$--$4$} точки и не выше второй производной).

\vspace{3mm}
{\bf 1. Интерполирование с кратными узлами}
\vspace{3mm}

Интерполирование с кратными узлами~-- частный случай,
когда задача Биркгофа разрешима.
Пусть
$s_1, \dots ,s_k$~-- целые {неотрицательные}.
%\begin{center}
%\begin{align*}
%0 \le r \le s_1&,  \\
%0 \le r \le s_2&,   \\
%  \cdots\quad \quad &,          \\
%0 \le r \le s_k&,
%\end{align*}
%\end{center}
Надо построить многочлен, для которого в точках
$x_i$~ $(i=1,\dots ,k)$ выполнены равенства
\[
  p^{(r)}(x_i)=f^{(r)}(x_i),\qquad 0 \le r \le s_i\qquad (i=1,\ldots ,k).
\]
Здесь $N=s_1+s_2+\cdots +s_k+k$
и $p(x)$~-- многочлен степени $N-1$
{и функция $f$} {должное число раз непрерывно дифференцируема}.

\begin{teo}
Интерполяционная задача с кратными узлами
всегда разрешима, {и} всегда имеет единственное решение.
\end{teo}

\begin{proof}
Задача линейная, поэтому достаточно доказать, что соответствующая однородная задача
в классе многочленов степени $N-1$ всегда имеет единственное (нулевое) решение.
То есть если $a \le x_1 < x_2 < \cdots < x_k \le b,$
то многочлен $p(x)$ такой, что
\[
 p^{(r)}(x_i)=0,\qquad 0 \le r \le s_i\qquad (i=1,\dots ,k),
\]
 тождественно равен нулю.

 Эти условия означают, что каждая
 точка $x_i\ (i=1,\ldots,k)$ является корнем кратности $s_i+1$ многочлена
 $p(x).$ Значит $p(x)$ (многочлен степени $N-1$) должен
 делиться на многочлен $\prod\limits_{i=1}^k
 (x-x_i)^{s_i+1}.$ Это возможно, но только если $p(x)\equiv 0.$
 Теорема доказана.
\end{proof}

\vspace{5mm}
{\bf 2. Интерполяционная задача Эрмита}
\vspace{5mm}

Пусть в задаче интерполирования с кратными узлами
все числа $s_1=s_2= \dots =s_n=~1$ и
$$
   p(x_k)=f(x_k)\qquad (k=1,\dots ,n),
   $$
   $$
   p'(x_k)=f'(x_k)\qquad (k=1,\dots ,n).
$$
Тогда $N=2n$
и многочлен должен быть степени $2n-1.$
Этот многочлен $p(x)=H(x,f)$
может быть представлен через фундаментальные
многочлены Эрмита
\[
  H(x,f)=\sum\limits_{k=1}^{n} \{f(x_k) A_k(x)+f'(x_k)B_k(x)\},
\]
где $A_k(x)$ и $B_k(x)$~-- фундаментальные многочлены эрмитовой
интерполяции, т.\,е.
\begin{equation}
\label{Eqs}
  \begin{cases}
        A_k(x_i)=\delta_{ik},\\
        A_k'(x_i)=0,
  \end{cases}
  \qquad
  \begin{cases}
        B_k(x_i)=0, \\
        B_k'(x_i)=\delta_{ik},
  \end{cases}
\end{equation}
$A_k(x)$ и $B_k(x)$~-- многочлены степени не выше $2n-1.$
Найдем их вид. Пусть $l_k(x)$~-- фундаментальные многочлены
Лагранжа, соответствующие {тем же} узлам $x_1<x_2< \dots
<x_n,$ т.\,е. $l_k(x) \in \Cal P_{n-1},$
$l_k(x_i)=\delta_{i,k},$
\[
  l_k(x)=\frac{\omega (x)}{(x-x_k)\omega '(x_k)},
\]
где $\omega (x)=\prod\limits_{k=1}^n (x-x_k).$
{Ясно, что $l'_k(x_k)$~-- конечные числа $(k=1,2,\ldots,n).$}

Значит, {можно положить}
$$
   A_k(x)=\Bigl\{ 1-(x-x_k)2l'_k(x_k) \Bigr\}\cdot l^2_k(x),
   $$
   $$
   B_k(x)=(x-x_k)l_k^2(x).
$$

Легко проверить справедливость равенств~(\ref{Eqs}).

\vspace{5mm}
{\bf 3. Остаточный член для интерполяционной задачи с
   кратными узлами}
   \vspace{5mm}

Итак, пусть есть интерполяционная задача с кратными
узлами, таблица параметров
\begin{align*}
x_1, \quad s_1&,  \\
x_2, \quad s_2&,  \\
  \cdots\quad \quad &,          \\
x_k, \quad s_k&,
\end{align*}
где $s_1+s_2+\cdots{+} s_k+k=N.$ {Степень} многочлена
{равна} $N-1.$ {Однозначно определяемый соответствующий
многочлен кратного интерполирования для} {функции $f$ будем
обозначать через $H(x)=H(x,f).$}

Для остаточного члена этой интерполяционной формулы с
помощью теоремы Ролля легко доказывается следующее
утверждение.

\begin{teo}
{Если $f\in C^{(N)}[a,b],$ то для} любого $x \in [a,b]$
найдется точка $\xi \in (a,b)$ такая, что
\[
  f(x)-H(x,f)=\frac{f^{(N)}(\xi )}{N!}\Omega (x),
\]
где {$\Omega (x)=\prod\limits_{j=1}^k(x-x_j)^{s_j+1}$~--
многочлен степени $N$}.
\end{teo}

\begin{proof}
Если $x=x_i,$ то {формула} верна, так как $\Omega(x_i)=0$ $(i=1,\dots ,k).$
Следовательно, можем предполагать, что $x \ne x_i,$ $x \in [a,b],$ $(i=1,\dots ,k).$
Пишем вспомогательную функцию
\[
  \phi(z)=f(z)-H(z)-\frac{f(x)-H(x)}{\Omega (x)}\, \Omega (z).
\]
Для этой функции
{$\phi(x)=0$ и, так как $\Omega^{(r)}(x_i)=0$ при $r=0,1,\ldots,s_i,$ то}
\[
\phi^{(r)}(x_i)=0\qquad (r=0,1, \dots ,s_i;\quad i=1, \dots ,k).
\]
Значит, $\phi(z)$ имеет {ровно} $s_1+\cdots +s_k +k+1=N+1$ {нулей с учетом кратности}, и по
теореме Ролля найдется точка $\xi \in (a,b)$ такая, что
$\phi^{(N)}(\xi)=0,$ т.\,е.
\[
  f^{(N)}(\xi )-\frac{f(x)-H(x)}{\Omega (x)} N!=0.
\]
{Теорема доказана.}
\end{proof}

\begin{Corollary}
Справедлива оценка
$$
|f(x)-H(f,x)|\le
\dfrac{|\Omega(x)|}{N!}\|f^{(N)}\|_{C[a,b]},
$$
где $f\in C^{(N)}[a,b],\
x\in [a,b].$
\end{Corollary}
